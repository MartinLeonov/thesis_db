<html>

  <!-- NOTE!!! Chromium has to be run with flags: --args --disable-web-security --allow-file-access-from-files  -->

  <head>
    <meta charset="ISO-8859-1">

    <style>
      td
        {
          border: 1px solid black;
          padding: 5px;
        }

      table
        {
          border-collapse: collapse;
        }

      a
        {
          text-decoration: none;
        }

      form
        {
          font-size: 10px;
          background-color: rgb(240,240,240);
          padding: 20px;
          border-radius: 10px;
          margin: 30xp;
        }

      .tab
        {
          display: inline-block;
          width: 100px;
          height: 30px;
          padding: 0;
          margin: 0;
        }

       .search
        {
          width: 100%;
          height: 30px;
          font-weight: bold;
        }

    </style>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <script>
      theses = null;

      function person_to_string(person)
        {
          result = "";

          for (i in person.degrees)
            result += person.degrees[i] + " ";

          result += person.name_first + " " + person.name_last;

          return result;
        }

      function to_str(thing)
        {
          if (thing == null) 
            return "";

          return "" + thing;
        }

      function display_thesis_list(thesis_list)
        {
          $("#thesis_list").empty();

          for (i in thesis_list)
            {
              t = thesis_list[i];

              table_row = "<tr> " +
                "<td>" + to_str(t.degree) + "</td>" +
                "<td>" + to_str(t.faculty) + "</td>" +
                "<td>" + to_str(t.language) + "</td>" +
                "<td>" + person_to_string(t.author) + "</td>" +
                "<td>" + person_to_string(t.supervisor) + "</td>" +
                "<td>" + to_str(t.grade) + "</td>" +
                "<td> <a href=\"" + t.url_page + "\">" +  (t.title_cs != null ? t.title_cs : t.tile_en) + "</a> </td>";

              if (t.url_fulltext != null)
                table_row += "<td> <a href=\"" + t.url_fulltext + "\"> full </a> </td>"
              else
                table_row += "<td> </td>"


              table_row += "<td>" + to_str(t.pages) + "</td>" +
                "</tr>";


              $("#thesis_list").append(table_row);
            }
        }

      $.getJSON("theses.json", function(json)
        {
          theses = json;
        });

      function input_value(input_name)
        {
          return $("input[name=" + input_name + "]").val();
        }

      function checkbox_checked(checkbox_name)
        {
          return $("input[name=" + checkbox_name + "]").is(":checked");
        }

      function meets_criteria(thesis)
        {

          if (!checkbox_checked("do_bachelor") && thesis.kind == "bachelor")
            return false;

          if (!checkbox_checked("do_master") && thesis.kind == "master")
            return false;

          if (!checkbox_checked("do_dr") && thesis.kind == "small doctorate")
            return false;

          if (!checkbox_checked("do_phd") && thesis.kind == "PhD")
            return false;

          if (!checkbox_checked("do_doc") && thesis.kind == "habilitation")
            return false;

          if (!checkbox_checked("do_grade_unknown") && thesis.grade == null)
            return false;

          if (thesis.grade == "A" && !checkbox_checked("do_a"))
            return false;

          if (thesis.grade == "B" && !checkbox_checked("do_b"))
            return false;

          if (thesis.grade == "C" && !checkbox_checked("do_c"))
            return false;

          if (thesis.grade == "D" && !checkbox_checked("do_d"))
            return false;

          if (thesis.grade == "E" && !checkbox_checked("do_e"))
            return false;

          if (thesis.grade == "F" && !checkbox_checked("do_f"))
            return false;

          if (thesis.language == null && !checkbox_checked("do_lang_unknown"))
            return false;

          if (thesis.language == "cs" && !checkbox_checked("do_cs"))
            return false;

          if (thesis.language == "sk" && !checkbox_checked("do_sk"))
            return false;
          
          if (thesis.language == "en" && !checkbox_checked("do_en"))
            return false;
          
          return true;
        }

      function search_clicked()
        {
          result = [];

          for (i in theses)
            {
              if (meets_criteria(theses[i]))
                result.push(theses[i]);
            }

          display_thesis_list(result);
        }

    </script>

  </head>

  <body>

    <h1> Czech Computer Science Theses </h1>

    <form>
      search for: <input type="text" name="search_for">
      max results: <input type="number" name="max_results" value="50"> <br/> <br/>

      <span class="tab"> <input type="checkbox" name="do_title" checked="checked"> in title </span>
      <span class="tab"> <input type="checkbox" name="do_names" checked="checked"> in names </span>
      <span class="tab"> <input type="checkbox" name="do_keywords" checked="checked"> in keyword </span>
      <span class="tab"> <input type="checkbox" name="do_abstract" checked="checked"> in abstract </span> <br />

      <span class="tab"> <input type="checkbox" name="do_bachelor" checked="checked"> Bc. </span>
      <span class="tab"> <input type="checkbox" name="do_master" checked="checked"> master </span>
      <span class="tab"> <input type="checkbox" name="do_dr" checked="checked"> dr. </span>
      <span class="tab"> <input type="checkbox" name="do_phd" checked="checked"> PhD. </span>
      <span class="tab"> <input type="checkbox" name="do_doc" checked="checked"> doc. </span> <br />

      <span class="tab"> <input type="checkbox" name="do_a" checked="checked"> A </span>
      <span class="tab"> <input type="checkbox" name="do_b" checked="checked"> B </span>
      <span class="tab"> <input type="checkbox" name="do_c" checked="checked"> C </span>
      <span class="tab"> <input type="checkbox" name="do_d" checked="checked"> D </span>
      <span class="tab"> <input type="checkbox" name="do_e" checked="checked"> E </span>
      <span class="tab"> <input type="checkbox" name="do_f" checked="checked"> F </span>
      <span class="tab"> <input type="checkbox" name="do_grade_unknown" checked="checked"> N/A </span> <br />

      <span class="tab"> <input type="checkbox" name="do_cs" checked="checked"> cs </span>
      <span class="tab"> <input type="checkbox" name="do_sk" checked="checked"> sk </span>
      <span class="tab"> <input type="checkbox" name="do_en" checked="checked"> en </span>
      <span class="tab"> <input type="checkbox" name="do_lang_unknown" checked="checked"> N/A </span> <br />

      <span class="tab"> <input type="checkbox" name="do_mff_cuni" checked="checked"> MFF CUNI </span>
      <span class="tab"> <input type="checkbox" name="do_fit_ctu" checked="checked"> FIT CTU </span>
      <span class="tab"> <input type="checkbox" name="do_fi_muni" checked="checked"> FI MUNI </span>
      <span class="tab"> <input type="checkbox" name="do_felk_ctu" checked="checked"> FELK CTU </span>
      <span class="tab"> <input type="checkbox" name="do_fit_vut" checked="checked"> FIT BUT </span>
      <span class="tab"> <input type="checkbox" name="do_fei_vsb" checked="checked"> FEI VSB </span>
      <span class="tab"> <input type="checkbox" name="do_fai_utb" checked="checked"> FAI UTB </span>
      <span class="tab"> <input type="checkbox" name="do_pef_mendelu" checked="checked"> PEF MEND </span>
      <span class="tab"> <input type="checkbox" name="do_uc" checked="checked"> UC </span>
      <span class="tab"> <input type="checkbox" name="do_faculty_other" checked="checked"> other </span> <br />

      <span class="tab"> <input type="checkbox" name="do_praha" checked="checked"> Praha </span>
      <span class="tab"> <input type="checkbox" name="do_brno" checked="checked"> Brno </span>
      <span class="tab"> <input type="checkbox" name="do_ostrava" checked="checked"> Ostrava </span>
      <span class="tab"> <input type="checkbox" name="do_zlin" checked="checked"> Zlin </span> <br />

      <span class="tab"> <input type="checkbox" name="do_fulltext" checked="checked"> fulltext </span> <br />

      year from: <input type="number" value="1990">
      year to: <input type="number" value="2020">
      <input type="checkbox" name="do_year_unknown" checked="checked"> unknown <br /> <br />

      <input class="search" type="button" value="search" onclick="search_clicked()">
    </form>

    <table id="thesis_list">
    </table>

  </body>

</html>
